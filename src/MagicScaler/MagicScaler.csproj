<Project Sdk="Microsoft.NET.Sdk">

	<PropertyGroup>
		<VersionPrefix>0.10.0</VersionPrefix>
		<TargetFrameworks>net46;net472;netcoreapp2.1;netcoreapp3.0;netstandard2.0;netstandard2.1</TargetFrameworks>
	</PropertyGroup>

	<PropertyGroup>
		<DefineConstants Condition="$(TargetFramework.StartsWith('netcoreapp')) Or '$(TargetFramework)'=='netstandard2.1'">$(DefineConstants);BUILTIN_MATHF;BUILTIN_SPAN</DefineConstants>
		<DefineConstants Condition="$(TargetFramework.StartsWith('netcoreapp')) Or '$(TargetFramework)'=='netstandard2.1' Or '$(TargetFramework)'=='net472'">$(DefineConstants);VECTOR_CONVERT</DefineConstants>
		<DefineConstants Condition="$(TargetFramework.StartsWith('net4')) Or '$(TargetFramework)'=='netcoreapp3.0'">$(DefineConstants);SYSTEM_DRAWING</DefineConstants>
		<DefineConstants Condition="'$(TargetFramework)'=='netcoreapp3.0' Or '$(TargetFramework)'=='netstandard2.1'">$(DefineConstants);BUILTIN_NULLABLE</DefineConstants>
		<DefineConstants Condition="'$(TargetFramework)'=='netcoreapp3.0'">$(DefineConstants);HWINTRINSICS</DefineConstants>
	</PropertyGroup>

	<PropertyGroup>
		<NoWarn Condition="'$(TargetFramework)'=='netcoreapp2.1' Or '$(TargetFramework)'=='netstandard2.1'">$(NoWarn);0618</NoWarn><!-- VarEnum spuriously marked obsolete -->
		<NoWarn Condition="'$(TargetFramework)'=='netstandard2.0'">$(NoWarn);IDT001;IDT002</NoWarn><!-- Bad docs in NuGet package -->
		<Nullable Condition="$(DefineConstants.Contains('BUILTIN_NULLABLE'))">enable</Nullable>
	</PropertyGroup>

	<ItemGroup Condition="!$(DefineConstants.Contains('BUILTIN_SPAN'))">
		<PackageReference Include="System.Memory" Version="4.5.3" />
		<PackageReference Include="System.Numerics.Vectors" Version="4.5.0" />
	</ItemGroup>

	<ItemGroup Condition="'$(TargetFramework)'=='netcoreapp3.0'">
		<PackageReference Include="System.Drawing.Common" Version="4.6.0" />
	</ItemGroup>

	<ItemGroup Condition="'$(TargetFramework)'!='netcoreapp3.0'">
		<PackageReference Include="System.Runtime.CompilerServices.Unsafe" Version="4.6.0" />
	</ItemGroup>

	<ItemGroup Condition="'$(TargetFramework)'=='net46'">
		<PackageReference Include="System.ValueTuple" Version="4.5.0" />
	</ItemGroup>

	<ItemGroup Condition="$(DefineConstants.Contains('NETFRAMEWORK'))">
		<Reference Include="System.Configuration" />
		<Reference Include="System.Drawing" />
	</ItemGroup>

	<ItemGroup>
		<Compile Include="$(BaseModulesPath)WicInterop\src\*.cs" />
		<Compile Include="$(BaseModulesPath)Blake2Fast\src\Blake2Fast\Blake2b\*.cs" />
		<Compile Include="$(BaseModulesPath)Blake2Fast\src\Blake2Fast\IBlake2Incremental.cs" />
		<Compile Include="$(BaseModulesPath)Blake2Fast\src\Blake2Fast\ThrowHelper.cs" />
		<EmbeddedResource Include="Resources\*.icc" />
	</ItemGroup>

	<ItemGroup>
		<Service Include="{508349b6-6b84-4df5-91f0-309beebad82d}" />
	</ItemGroup>

	<ItemGroup>
		<None Update="Magic\Generated\Convolver.tt">
			<Generator>TextTemplatingFileGenerator</Generator>
			<LastGenOutput>Convolver.cs</LastGenOutput>
		</None>
		<None Update="Magic\Generated\VectorConvolver.tt">
			<Generator>TextTemplatingFileGenerator</Generator>
			<LastGenOutput>VectorConvolver.cs</LastGenOutput>
		</None>
	</ItemGroup>

	<ItemGroup>
		<Compile Update="Magic\Generated\Convolver.cs">
			<DesignTime>True</DesignTime>
			<AutoGen>True</AutoGen>
			<DependentUpon>Convolver.tt</DependentUpon>
		</Compile>
		<Compile Update="Magic\Generated\VectorConvolver.cs">
			<DesignTime>True</DesignTime>
			<AutoGen>True</AutoGen>
			<DependentUpon>VectorConvolver.tt</DependentUpon>
		</Compile>
	</ItemGroup>

</Project>